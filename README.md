# ğŸ‘« Secondhand

<p align="center"><img src="https://github.com/masters2023-2nd-project-05/second-hand/assets/107349637/a9b41627-4e9c-4efd-8435-3366f50e17e8" width=400></p>

## í”„ë¡œì íŠ¸ ì†Œê°œ
>  ì§„í–‰ê¸°ê°„ : 2023. 06 ~ 2023. 08

//TODO ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ ì„¤ëª…ê³¼ ë™ê¸°

| ì´ë¦° | Dewey |
|:--:|:--:|
|<img src="https://avatars.githubusercontent.com/u/103120173?v=4" alt="ì´ë¦°" width="120" height="120">|<img src="https://avatars.githubusercontent.com/u/115435482?v=4" alt="ë“€ì´" width="120" height="120">|

---
## í”„ë¡œì íŠ¸ êµ¬ì¡°
```java
src
â”œâ”€â”€ main
â”‚Â Â  â”œâ”€â”€ java.com.team5.secondhand
â”‚Â Â  â”‚Â Â   â”œâ”€â”€ api    // ì™¸ë¶€ API
â”‚Â Â  â”‚Â Â   â”‚Â Â  â””â”€â”€ s3 // ì´ë¯¸ì§€ í˜¸ìŠ¤íŒ…
â”‚Â Â  â”‚Â Â   â”œâ”€â”€ application    // ê¸°ë³¸ API
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ chatroom   // ì±„íŒ…ë°© ê´€ë ¨ íŒ¨í‚¤ì§€
â”‚Â Â  â”‚Â    â”‚Â Â  â”œâ”€â”€ item       // íŒë§¤ ìƒí’ˆ ê´€ë ¨ íŒ¨í‚¤ì§€
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ member     // íšŒì› ê´€ë ¨ ë¡œíŒ¨í‚¤ì§€ì§
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ oauth      // oauth ê´€ë ¨ íŒ¨í‚¤ì§€
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ region     // ì§€ì—­ ê´€ë ¨ íŒ¨í‚¤ì§€
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ resource   // ì´ˆê¸° ë°ì´í„° ë°˜í™˜ íŒ¨í‚¤ì§€
â”‚Â Â  â”‚Â Â   â”‚Â Â  â””â”€â”€ wishlist   // ì¢‹ì•„ìš” í‘œì‹œí•œ ìƒí’ˆ ê´€ë ¨ íŒ¨í‚¤ì§€
â”‚Â Â  â”‚Â Â   â”œâ”€â”€ chat              // ì±„íŒ… API
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ bubble        // ì±„íŒ…ë©”ì‹œì§€
â”‚Â Â  â”‚Â Â   â”‚Â Â  â”œâ”€â”€ chatroom      // ì±„íŒ…metainfo
â”‚Â Â  â”‚Â Â   â”‚Â Â  â””â”€â”€ notification  // ì±„íŒ… ì•ŒëŒ
â”‚Â Â  â”‚Â Â   â””â”€â”€ global
â”‚Â Â  â”‚Â Â       â”œâ”€â”€ auth
â”‚Â Â  â”‚Â Â       â”œâ”€â”€ config
â”‚Â Â  â”‚Â Â       â”œâ”€â”€ exception
â”‚Â Â  â”‚Â Â       â”œâ”€â”€ model
â”‚Â Â  â”‚Â Â       â”œâ”€â”€ properties
â”‚Â Â  â”‚Â Â       â””â”€â”€ util
â”‚Â Â  â””â”€â”€ resources
â””â”€â”€ test
 Â Â  â””â”€â”€ java.com.team5.secondhand
        â”œâ”€â”€ integration    // í†µí•©í…ŒìŠ¤íŠ¸
        â””â”€â”€ unit           // ë‹¨ìœ„í…ŒìŠ¤íŠ¸
```

---
## êµ¬ì„±ë„
### ì¸í”„ë¼ êµ¬ì„±
![image](https://github.com/masters2023-2nd-project-05/second-hand-BE/assets/103120173/9e6093ce-7618-411d-8ddf-738070a21865)

### RDB êµ¬ì„±
//TODO ë“€ì´

---
## API ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡
- ìì„¸í•œ ë‚´ìš©ì€ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”. [ë§í¬](https://documenter.getpostman.com/view/27928775/2s9Y5Wy4Jc)

<details><summary>ê³„ì • ë° ì¸ì¦ (Authentication and Account)</summary>
 
| ì„¤ëª…                                     | HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸                    |
|------------------------------------------|-------------|------------------------------|
| ì‚¬ìš©ìëŠ” ë¡œê·¸ì•„ì›ƒ í•  ìˆ˜ ìˆë‹¤.             | GET         | /logout                      |
| ì‚¬ìš©ìëŠ” OAuthë¥¼ í†µí•´ ë¡œê·¸ì¸ í•  ìˆ˜ ìˆë‹¤.  | GET         | /git/login?code={string}&env={PROD} |
| ì‚¬ìš©ìëŠ” íšŒì›ê°€ì…ì„ í•  ìˆ˜ ìˆë‹¤ (Github/ì¼ë°˜ ê°€ì…). | POST | /join |
| ì‚¬ìš©ìëŠ” ì•„ì´ë”” ì¤‘ë³µí™•ì¸ì„ í•  ìˆ˜ ìˆë‹¤.     | GET         | /join/availability?memberId={memberId} |
| ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ì„ í•  ìˆ˜ ìˆë‹¤.             | POST        | /login                       |
| ì‚¬ìš©ìëŠ” í”„ë¡œí•„ ì‚¬ì§„ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.    | PATCH       | /members/image               |

</details>

<details><summary>ìƒí’ˆ ê´€ë¦¬ (Item Management)</summary>

| ì„¤ëª…                                       | HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸                             |
|--------------------------------------------|-------------|---------------------------------------|
| ì‚¬ìš©ìëŠ” ìƒˆë¡œìš´ ìƒí’ˆì„ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.    | POST        | /items                               |
| íŒë§¤ìëŠ” ìƒí’ˆ ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.     | PUT         | /items/{id}                          |
| ì‚¬ìš©ìëŠ” ìƒí’ˆì˜ ìƒì„¸ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.  | GET         | /items/{id}                          |
| íŒë§¤ìëŠ” íŒë§¤ì¤‘ì¸ íŒë§¤ ìƒí’ˆ ëª©ë¡ì—ì„œ ê¸€ì„ ì‚­ì œí•  ìˆ˜ ìˆë‹¤. | DELETE | /items/{id}                          |
| íŒë§¤ìëŠ” ìƒí’ˆ íŒë§¤ ìƒíƒœë§Œ ë³„ë„ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤. | PATCH | /items/{id}/status                  |
| ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë™ë„¤ì˜ ìƒí’ˆ ëª©ë¡ì„ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /items?page={number}&region={id}    |
| ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë™ë„¤ì˜ ìƒí’ˆ ëª©ë¡ì„ íŠ¹ì • ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /items?page={number}&region={id}&category={id} |
| ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë™ë„¤ì˜ íŒë§¤ì¤‘ì¸ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /items/categories?regionId={id}   |
| ì‚¬ìš©ìëŠ” ìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•  ìˆ˜ ìˆë‹¤.    | POST        | /items/image                         |
| ì‚¬ìš©ìëŠ” ìì‹ ì´ íŒë§¤ì™„ë£Œí•œ ìƒí’ˆ ëª©ë¡ì„ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /items/mine?page={number}&isSales={boolean} |
| ì‚¬ìš©ìëŠ” ìì‹ ì´ íŒë§¤ì¤‘ì¸ ìƒí’ˆ ëª©ë¡ì„ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /items/mine?page={number}&isSales={boolean} |

</details>

<details><summary>ì±„íŒ… (Chat)</summary>

| ì„¤ëª…                                       | HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸                            |
|--------------------------------------------|-------------|--------------------------------------|
| êµ¬ë§¤ìëŠ” íŒë§¤ìì—ê²Œ íŒë§¤ìƒí’ˆì— ëŒ€í•œ ì±„íŒ…ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤. | POST | /chats                           |
| ì‚¬ìš©ìëŠ” ë‚˜ì˜ ì±„íŒ… ë‚´ì—­ì„ ëª¨ë‘ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /chats?page={number}&itemId={number} |
| ì‚¬ìš©ìëŠ” ì•„ì´í…œ ìƒì„¸ë³´ê¸°ì—ì„œ ì±„íŒ…ë°©ì— ì…ì¥í•  ìˆ˜ ìˆë‹¤. | GET | /chats/items/{itemId}             |
| ì‚¬ìš©ìëŠ” ë‚˜ì˜ ì±„íŒ… ë‚´ì—­ì˜ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. | GET | /chats/subscribe                   |
| ì‚¬ìš©ìëŠ” ì±„íŒ…ë°©ì—ì„œ ë‚˜ê°ˆ ìˆ˜ ìˆë‹¤ (ì‚­ì œ). | DELETE | /chats/{chatId}                  |
| ì‚¬ìš©ìëŠ” ëŒ€í™”í•˜ë˜ ì±„íŒ…ë°©ì— ë‹¤ì‹œ ì…ì¥í•  ìˆ˜ ìˆë‹¤. | GET | /chats/{chatId}                   |
| ì‚¬ìš©ìëŠ” ì•„ì´í…œì— ëŒ€í•œ ì´ì „ ì±„íŒ… ë¡œê·¸ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤. | GET | /chats/{chatId}/logs?page={number} |

</details>

<details><summary>ì‹¤ì‹œê°„ ì±„íŒ… (Live Chat)</summary>

- ì›¹ì†Œì¼“ í”„ë¡œí† ì½œì…ë‹ˆë‹¤.

| ì„¤ëª…                            | ì—”ë“œí¬ì¸íŠ¸                     |
|-------------------------------|------------------------------|
| ì‚¬ìš©ìëŠ” ì±„íŒ… ì†Œì¼“ì„ ì—°ê²°í•  ìˆ˜ ìˆë‹¤. | /chat                          |
| ì‚¬ìš©ìëŠ” ì±„íŒ…ë°©ì— ì…ì¥í•  ìˆ˜ ìˆë‹¤. (subscribe) | /sub/{chatroomId} |
| ì‚¬ìš©ìëŠ” ì±„íŒ…ë°©ì— ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë‹¤. (publish) | /pub/message             |
 
</details>

<details><summary>ìƒí’ˆ ê´€ì‹¬ ë“±ë¡ (Wishlist)</summary>

| ì„¤ëª…                                       | HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸                             |
|--------------------------------------------|-------------|---------------------------------------|
| ì‚¬ìš©ìëŠ” ê´€ì‹¬ìƒí’ˆìœ¼ë¡œ ë“±ë¡í•œ ê¸€ì˜ ëª©ë¡ ì „ì²´ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /wishlist?page={number} |
| ì‚¬ìš©ìëŠ” ê´€ì‹¬ìƒí’ˆìœ¼ë¡œ ë“±ë¡í•œ ê¸€ì˜ ëª©ë¡ì„ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /wishlist?page={number}&category={id} |
| ì‚¬ìš©ìëŠ” ê´€ì‹¬ìƒí’ˆìœ¼ë¡œ ë“±ë¡í•œ ì•„ì´í…œì˜ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /wishlist/categories |
| ì‚¬ìš©ìëŠ” ìƒí’ˆì„ ê´€ì‹¬ìƒí’ˆìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆë‹¤ (ì¢‹ì•„ìš” ëˆ„ë¥´ê¸°). | POST | /wishlist/like |
| ì‚¬ìš©ìëŠ” ê´€ì‹¬ìƒí’ˆì„ ê´€ì‹¬ìƒí’ˆ ëª©ë¡ì—ì„œ ì‚­ì œí•  ìˆ˜ ìˆë‹¤ (ì¢‹ì•„ìš” í•´ì œ). | DELETE | /wishlist/like?itemId={number} |

</details>


<details><summary>ë¦¬ì†ŒìŠ¤ ë° ê¸°íƒ€ (Resources and etc...)</summary>

| ì„¤ëª…                                       | HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸                             |
|--------------------------------------------|-------------|---------------------------------------|
| ì‚¬ìš©ìëŠ” ë™ë„¤ ëª…ë‹¨ì„ ë³¼ ìˆ˜ ìˆë‹¤. | GET | /regions?address={string} |
| ì´ˆê¸° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. | GET | /resources |
| ì‚¬ìš©ìëŠ” ì¹´í…Œê³ ë¦¬ ë¦¬ì†ŒìŠ¤ ì •ë³´ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. | GET | /resources/categories |

 </details>

---
## ì£¼ìš” ê¸°ëŠ¥
### ê¸°ëŠ¥1. OAuth2.0ì„ ì ìš©í•œ íšŒì›ê°€ì… ë° íšŒì› ì¸ì¦ ì ˆì°¨
- ì‚¬ìš©ì ë°ì´í„°ì— ëŒ€í•œ ë³´ì•ˆê³¼ í¸ì˜ì„±ì„ ìœ„í•´ OAuth 2.0ì„ ì‚¬ìš©í•˜ì—¬ íšŒì›ê°€ì…ì„ í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
- OAuth ì„œë²„ë¥¼ í†µí•´ ì‚¬ìš©ì ì¸ì¦ì„ ì™„ë£Œí•œ í›„, ì ì‹œ sessionì— ì´ ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì‚¬ìš©ìë¡œë¶€í„° ì¶”ê°€ë¡œ í•„ìš”í•œ ì§€ì—­ ì •ë³´ë¥¼ ì…ë ¥ë°›ì•„ íšŒì›ê°€ì…ì„ ì™„ë£Œí•˜ê³  ì´ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.
- OAuth ì„œë²„ ì¸ì¦ ì´í›„ ìœ íš¨ì‹œê°„ 30ë¶„ ì´í›„ì— ì¶”ê°€ ì •ë³´ ì…ë ¥ì„ ì‹œë„í•  ê²½ìš°, ì˜ˆì™¸ê°€ ë°œìƒí•˜ì—¬ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì²˜ìŒë¶€í„° ê°€ì… ì ˆì°¨ë¥¼ ê±°ì³ì•¼ í•©ë‹ˆë‹¤.

#### OAuth íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ Sequence Diagram
```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant Client as Web server
    participant Server as WAS
    participant OAuthServer as OAuth ì„œë²„

    User ->> Client: ì¸ì¦ ìš”ì²­
    Client ->> User: ë¦¬ë‹¤ì´ë ‰íŠ¸ URL ìƒì„±
    User -->> Client: ì‚¬ìš©ì ë¦¬ë‹¤ì´ë ‰ì…˜
    Client ->> OAuthServer: ì‚¬ìš©ì ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬ ìš”ì²­
    OAuthServer -->> Client: ì‚¬ìš©ì ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬ í™•ì¸
    Client ->> Server: íšŒì›ê°€ì… ìš”ì²­
    activate Server
    Server ->> OAuthServer: íšŒì› ì •ë³´ ìš”ì²­
    OAuthServer -->> Server: íšŒì› ì •ë³´ ë°˜í™˜
    Server -->> Server: Server Sessionì— íšŒì› ì •ë³´ ì„ì‹œ ì €ì¥
    Server -->> Client: ì¶”ê°€ ì§€ì—­ ì •ë³´ í•„ìš” ìš”ì²­
    deactivate Server
    Client ->> User: ì§€ì—­ ì •ë³´ ì…ë ¥ í¼ í‘œì‹œ
    User -->> Client: ì§€ì—­ ì •ë³´ ì œì¶œ
    Client ->> Server: ì§€ì—­ ì •ë³´ì™€ SID ì „ë‹¬
    activate Server
    Server -->> Server: íšŒì›ê°€ì… ë¡œì§ ì²˜ë¦¬
    Server -->> Client: íšŒì›ê°€ì… ì™„ë£Œ ì‘ë‹µ
    deactivate Server
    Client -->> User: ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜
    User ->> Client: ë¡œê·¸ì¸ ìš”ì²­
    Client ->> Server: ë¡œê·¸ì¸ ìš”ì²­
    activate Server
    Server -->> Server: Jwt í† í° ë°œê¸‰
    Server -->> Client: ë¡œê·¸ì¸ ì™„ë£Œ ë° í† í° ì‘ë‹µ
    deactivate Server
    Client -->> User: ë¡œê·¸ì¸ ì™„ë£Œ ë° í† í° ì‘ë‹µ
```

#### ì‚¬ìš©ì ê¶Œí•œì´ í•„ìš”í•œ ìš”ì²­ì„ í–ˆì„ ë•Œ Sequence Diagram
- ì‚¬ìš©ì ê¶Œí•œ ì´ í•„ìš”í•œ ìš”ì²­ì„ í–ˆì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ ìš”ì²­ë§ˆë‹¤ ì‚¬ìš©ì ì •ë³´ë¥¼ `Authorization` headerì—ì„œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.

```mermaid
sequenceDiagram
    participant Client as í´ë¼ì´ì–¸íŠ¸
    participant Filter as Servlet Filter
    participant Jwt as JwtUtil
    participant Context as Authorization Context
    participant Controller as Controller
    participant Service as Service

    Client ->> Filter: ë³´í˜¸ëœ í˜ì´ì§€ ìš”ì²­
    Filter ->> Jwt: Authorization í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ
    activate Jwt
    Jwt -->> Jwt: í† í° ìœ íš¨ì„± ê²€ì¦
    Jwt -->> Jwt: í´ë ˆì„ ì¶”ì¶œ
    Jwt -->> Filter: í´ë ˆì„ ì „ë‹¬
    deactivate Jwt
    Filter ->> Context: í´ë ˆì„ ì €ì¥
    Context -->> Controller: ì‚¬ìš©ì ì •ë³´ ë° ê¶Œí•œ ì¶”ì¶œ
    Controller ->> Service: ìš”ì²­ ì „ë‹¬
    activate Service
    Service -->> Controller: ì‘ë‹µ ë°˜í™˜
    deactivate Service
    Controller -->> Filter: ì‘ë‹µ ë°˜í™˜
    Filter -->> Client: ì‘ë‹µ ë°˜í™˜
```

---

### ê¸°ëŠ¥2. ì‹¤ì‹œê°„ ì±„íŒ… ë° ì•ŒëŒ êµ¬ì¡°
- ì‹¤ì‹œê°„ ì±„íŒ…ì„ í•˜ê¸° ìœ„í•´ì„œ STOMP í”„ë¡œí† ì½œê³¼ Redis Pub/Sub ì„ í™œìš©í•˜ì—¬ ì±„íŒ… ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
- CONNECT ìš”ì²­ë§ˆë‹¤ ì‚¬ìš©ì ì •ë³´ë¥¼ `Authorization` headerì—ì„œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
- Web Socket ì—°ê²° ì¤‘ì— ì˜ˆì™¸ ë°œìƒ ì‹œ, í•´ë‹¹ ì—°ê²°ì€ Disconnect ë˜ê³  ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì—°ê²° ì‹œë„ë¥¼ í•´ì•¼í•©ë‹ˆë‹¤. (ì˜ˆì™¸ ë°œìƒ ê²½ìš° ëª‡ ê°œ ìˆëŠ”ë° ë‹¤ ì ì–´ì•¼í•˜ë‚˜? stomp êµ¬ì¡°ì— ë§ì§€ ì•Šì€ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê±°ë‚˜, ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê±°ë‚˜, ê²½ë¡œê°€ ì˜ëª»ë˜ê±°ë‚˜ ë“±ë“±)
- ì˜êµ¬ì ì¸ ì €ì¥ì´ í•„ìš”ì—†ëŠ” ì±„íŒ…ë°© ì°¸ì—¬ì ìƒíƒœ ì •ë³´ëŠ” Redis ì— ìºì‹œë¡œ ì €ì¥ë˜ê³ , ì˜êµ¬ì ì¸ ì €ì¥ì´ í•„ìš”í•œ ì±„íŒ…ë°© ì •ë³´ì™€ ë©”ì‹œì§€ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.

#### ì±„íŒ… íë¦„ Sequence Diagram

```mermaid
sequenceDiagram
    participant User
    participant WebServer
    participant WAS
    participant Redis
    participant Database

    WAS->>Redis: ì±„íŒ… topic êµ¬ë…
    User->>WebServer: íŒë§¤ê¸€ì—ì„œ ì±„íŒ…í•˜ê¸° í´ë¦­
    WebServer->>WAS: ì±„íŒ…ë°© ì§„ì… ìš”ì²­
    WAS->>Database: ì±„íŒ…ë°© ì •ë³´ ì¡°íšŒ
    opt ì±„íŒ…ë°©ì´ ìƒì„±ë˜ì§€ ì•Šì€ ê²½ìš°
        WAS->>WAS: ì±„íŒ…ë°© ìƒì„±
        WAS->>Database: ì±„íŒ…ë°© ì •ë³´ ì €ì¥
        WAS->>Redis: ì±„íŒ…ë°© ì°¸ì—¬ì ë©”íƒ€ì •ë³´ ì €ì¥
    end
    Database-->>WAS: ì±„íƒ•ë°© ì •ë³´ ë°˜í™˜
    WAS-->>WebServer: ì±„íŒ…ë°© ì •ë³´ ë°˜í™˜
    WebServer->>WAS: ì±„íŒ…ë°© Connect ìš”ì²­
    WAS-->>WAS: Connect ê²€ì¦
    WAS-->>Redis: ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì‚¬ìš©ì ì„¸ì…˜ ì •ë³´ ì €ì¥
    WebServer->>WAS: Subscribe (ì±„íŒ…ë°© ID) ìš”ì²­
    WAS-->>WAS: Subscribe (ì±„íŒ…ë°© ID) ê²€ì¦
    WAS-->>Redis: ì±„íŒ…ë°© ì°¸ì—¬ì ë©”íƒ€ì •ë³´ ê°±ì‹ 
    loop ì‚¬ìš©ì ì±„íŒ…
        User->>WebServer: ì±„íŒ… ë©”ì‹œì§€ ì…ë ¥ ë° ë³´ë‚´ê¸°
        WebServer->>WAS: Send ìš”ì²­
        WAS->>+Redis: ì±„íŒ… ë©”ì‹œì§€ ìˆ˜ì‹  ë° ì±„íŒ… topicìœ¼ë¡œ ë°œí–‰
        WAS->>Database: ì±„íŒ… ë‚´ìš© ì €ì¥
        Redis-->>-WAS: ì±„íŒ… topicì„ êµ¬ë…í•œ ì„œë²„ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸
        WAS-->>WebServer: ì±„íŒ…ë°©ì— ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ ì „ë‹¬
        WebServer->>User: ì±„íŒ… ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
    end
    User->>WebServer: ì±„íŒ…ë°© ì ‘ì† ì¢…ë£Œ
    WebServer->>WAS: Unsubscribe ìš”ì²­ 
    WAS-->>WAS: Unsubscribe ê²€ì¦
    WAS-->>Redis: ì±„íŒ…ë°© ì°¸ì—¬ì ë©”íƒ€ì •ë³´ ê°±ì‹ 
    WebServer-->>WAS: Disconnect ìš”ì²­
    WAS-->>Redis: ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì‚¬ìš©ì ì„¸ì…˜ ì •ë³´ ì‚­ì œ 
    loop TTLì£¼ê¸° ë§ˆë‹¤
        Redis-->>Database: ì±„íŒ… ë©”íƒ€ ì •ë³´ ì €ì¥
    end
```

#### ì±„íŒ… ì•ŒëŒ Sequence Diagram

- ì‚¬ìš©ìê°€ WebSocket ì—°ê²°ì´ ëŠê²¨ë„ ì±„íŒ… ì•ŒëŒì„ ë°›ê¸° ìœ„í•´ SSEë¥¼ í™œìš©í•˜ì—¬ ì±„íŒ… ì•ŒëŒ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
```mermaid
sequenceDiagram
    participant User
    participant WebServer
    participant WAS
    participant Redis
    
    User->> WebServer: ë¡œê·¸ì¸
    loop
        WebServer->>+WAS: SSE ì—°ê²° ìš”ì²­
        WAS-->>WebServer: SSE ì—°ê²° ìŠ¹ì¸
        loop 
            User->> WebServer: ì±„íŒ… ë©”ì‹œì§€ ë³´ë‚´ê¸°
            WebServer->>+WAS: ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
            WAS->>Redis: ë©”ì‹œì§€ ì €ì¥
            WAS->>-WebServer: SSEë¥¼ í†µí•œ ë©”ì‹œì§€ ì•Œë¦¼ ì „ì†¡
        end
        alt SSE íƒ€ì„ì•„ì›ƒì¼ ê²½ìš°
            WebServer->>WAS: SSE ì—°ê²° ì¬ìš”ì²­
            WAS-->>WebServer: SSE ì—°ê²° ìŠ¹ì¸
        end
        WebServer->>WAS: SSE ì—°ê²° ì¢…ë£Œ ìš”ì²­
        WAS-->>-WebServer: SSE ì—°ê²° ì¢…ë£Œ ì‘ë‹µ
    end
```

### ê¸°ëŠ¥3. 


---
## ğŸ§‘ğŸ»â€ğŸ’» ê¸°ìˆ ìŠ¤íƒ
![Java](https://img.shields.io/badge/-Java-007396?style=flat&logo=Java&logoColor=white)
![SpringBoot](https://img.shields.io/badge/-Spring_Boot-6DB33F?style=flat&logo=Spring-Boot&logoColor=white)
![SpringDataJPA](https://img.shields.io/badge/-Spring_Data_JPA-6DB33F?style=flat&logo=Spring&logoColor=white)
![MySQL](https://img.shields.io/badge/-MySQL-4479A1?style=flat&logo=MySQL&logoColor=white)   
![AWS EC2](https://img.shields.io/badge/-AWS_EC2-232F3E?style=flat&logo=Amazon-AWS&logoColor=white)
![AWS S3](https://img.shields.io/badge/-AWS_S3-569A31?style=flat&logo=Amazon-S3&logoColor=white)
![AWS RDS](https://img.shields.io/badge/-AWS_RDS-232F3E?style=flat&logo=Amazon-AWS&logoColor=white)
![Docker](https://img.shields.io/badge/-Docker-2496ED?style=flat&logo=Docker&logoColor=white)
![NginX](https://img.shields.io/badge/-NginX-269539?style=flat&logo=Nginx&logoColor=white)
![Github Action](https://img.shields.io/badge/-Github_Action-2088FF?style=flat&logo=Github-Action&logoColor=white)
